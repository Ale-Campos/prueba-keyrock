<div id="content_body">
  <div id="third_party_applications_page">
    <header>
      <div class="page-header">
        <p class="title">
          CUENTAS VINCULADAS.
        </p>
        <p>En esta página puedes...</p>
      </div>
    </header>

    <div id="card-container">
      <% if (applications.length > 0) {%>
        <div class="row">
          <% for (var i = 0; i < applications.length; i++) { %>
            <div class="col-sm-4" >
              <div class="panel panel-default info">
                <div class="panel-title">
                  <div class="app-logo-container">
                    <img class="app-logo" alt="application logo" src=<%=applications[i].image%>>
                  </div>
                  <div class="vector">
                      <a data-toggle="collapse" href="#collapse_delete_button_<%=[i]%>" aria-expanded="true" aria-controls="collapse_oauth2_credentials" class="collapsed">
                        <i class="fa fa-angle-up"></i>
                      </a>
                    <div class="collapse_out">
                      <div id="collapse_delete_button_<%=[i]%>" class="form-group collapse" role="tabpanel">
                          <div class="btn-group">
                            <button id="delete_application" title="Delete application" data-toggle="modal" data-target="#delete_application_modal<%=[i]%>" class="btn btn-default btn-sm ajax-modal">
                              Retirar acceso
                            </button>
                          </div>
                      </div>
                    </div>
                  </div>
                  <div class="panel-body clearfix">
                    <h1 class="app-name"><%=applications[i].name%></h1>
                  </div>
                </div>
                <hr>
                <div class="panel-body">
                  <input type='hidden' name='app_name' value='<%=applications[i].name%>' />
                      <h4 class="app-data">Tiene acceso a: <%= applications[i].shared_attributes%></h4>
                      <h4 class="app-data">Acceso concedido: <%= applications[i].login_date%></h4>
                </div>
              </div>
            </div>
            <div id="delete_application_modal<%=[i]%>" class="modal fade" style="top: 0px;" aria-hidden="false">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <a href="#" class="close" data-dismiss="modal">×</a>
                    <h3>Borrar mis datos de la aplicación</h3>
                  </div>
                  <form id="delete_application_form" ng-controller="DummyCtrl" name="" autocomplete="" class="" action="/idm/users/<%= user.id %>/_third_party_applications?_method=delete" method="POST" enctype="">
                    <input type='hidden' name='_csrf' value='<%= csrf_token%>' />
                    <input type="hidden" name="app_id" value="<%=applications[i].id%>"/>
                    <div class="modal-body clearfix">
                      <p>Estás a punto de borrar la siguiente aplicación</p>
                      <p><%=applications[i].name%></p>
                    </div>
                    <div class="modal-footer">
                      <input type="submit" class="btn btn-primary" value="Borrar">
                      <button data-dismiss="modal" class="btn btn-default secondary cancel">Cancelar</button>
                    </div>
                  </form>
                </div>
              </div>
            </div>
            <%}%>
          </div>
          <%} else { %>
            <div class="panel panel-default info">
              <div class="panel-body">
                <h2>No hay aplicaciones disponibles</h2>
              </div>
            </div>
            <%}-%>
          </div>

        </div>

        <%- include _delete_third_party_application %>


        <script type="text/javascript">
          $('.panel-title a:first-child').mouseover(function(){
            $(this).children().toggleClass('fa-rotate-180');
          });
          $('.panel-title a:first-child').mouseleave(function(){
            if ($(this).hasClass('collapsed')){
              $(this).children().removeClass('fa-rotate-180');
            } else {
              $(this).children().addClass('fa-rotate-180');
            }
          });
          $('.panel-title a:first-child').click(function(){
            if ($(this).hasClass('collapsed')){
              $(this).children().addClass('fa-rotate-180');
            } else {
              $(this).children().removeClass('fa-rotate-180');
            }
          });
        </script>
